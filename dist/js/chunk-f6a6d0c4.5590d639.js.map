{"version":3,"sources":["webpack:///./src/views/Management/MealCategory/MealCateEdit.vue?41c8","webpack:///./src/components/ImageInput.vue?f8e4","webpack:///./node_modules/@coreui/utils/src/make-uid.js","webpack:///src/components/ImageInput.vue","webpack:///./src/components/ImageInput.vue?2fbe","webpack:///./src/components/ImageInput.vue","webpack:///./src/views/Management/MealCategory/MealCateEdit.vue?fcbf","webpack:///./src/views/Management/MealCategory/MealCateEdit.js","webpack:///./src/views/Management/MealCategory/MealCateEdit.js?5f28","webpack:///./src/views/Management/MealCategory/MealCateEdit.vue","webpack:///./src/components/ImageInput.vue?9843"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","UploadImageSelectedStr","horizontal","isRequired","safeId","on","GetUploadImage","scopedSlots","_u","key","fn","class","LabelGridClass","_v","_s","label","_e","proxy","directives","name","rawName","value","expression","ImagePreviewTitle","style","maxPreview","ImagePreviewSrc","removeUploadImage","staticRenderFns","makeUid","Math","random","toString","substr","props","type","default","wasValidated","oldImage","limitSize","limitUnit","watch","val","UploadImage","data","UploadImageName","computed","methods","files","event","reader","Validfile","file","size","unit","alert","console","document","component","$route","ref","model","mealCateData","callback","$$v","$set","icon","$event","addSubCate","subCateList","length","changed","_l","subCate","idx","delSubCate","del","save","components","draggable","ImageInput","currId","params","id","name_zh","sort","Array","db_mealCateData","mounted","init","undefined","getMealCateData","$store","commit","url","ApiUrl","getUrl","AjaxService","get","successResp","restData","resultData","zhName","map","item","log","errorResp","checkChanged","cateChanged","JSON","stringify","confirm","push","$nextTick","querySelectorAll","focus","delete","splice","form","querySelector","classList","add","checkValidity","subData","image","sendData","post","$router","appCode","errorMsg","response","appMsg","$input","$refs","inputSlug","inputName","addInputClasses","invalidFeedback","getElementById","remove","url_base"],"mappings":"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","file":"js/chunk-f6a6d0c4.5590d639.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MealCateEdit.vue?vue&type=style&index=0&id=7a4738e6&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CInputFile',{staticClass:\"form-group\",attrs:{\"placeholder\":_vm.UploadImageSelectedStr,\"custom\":\"\",\"horizontal\":_vm.horizontal,\"required\":_vm.isRequired,\"accept\":\"image/*\",\"id\":_vm.safeId},on:{\"change\":_vm.GetUploadImage},scopedSlots:_vm._u([(_vm.horizontal)?{key:\"label\",fn:function(){return [_c('span',{class:_vm.LabelGridClass},[_vm._v(\" \"+_vm._s(_vm.label)+\" \"),(_vm.isRequired)?_c('span',{staticClass:\"text-danger\"},[_vm._v(\"*\")]):_vm._e()])]},proxy:true}:null,{key:\"description\",fn:function(){return [_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ImagePreviewSrc),expression:\"ImagePreviewSrc\"}],staticClass:\"mt-2\"},[_c('small',{staticClass:\"d-block\"},[_vm._v(_vm._s(_vm.ImagePreviewTitle))]),_c('label',{staticClass:\"position-relative img-thumbnail bg-white\",attrs:{\"for\":_vm.safeId}},[_c('img',{style:((\"max-width:\" + _vm.maxPreview)),attrs:{\"src\":_vm.ImagePreviewSrc,\"alt\":\"\"}}),_c('CButton',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.UploadImage),expression:\"UploadImage\"}],staticClass:\"align-top p-1\",attrs:{\"color\":\"danger\",\"shape\":\"pill\"},on:{\"click\":_vm.removeUploadImage}},[_c('CIcon',{staticClass:\"m-0\",attrs:{\"name\":\"cil-x\",\"size\":\"sm\"}})],1)],1)])]},proxy:true}],null,true)})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//function for UI releted ID assignment, due to one in 10^15 probability of duplication\r\nconst makeUid = () => {\r\n  const key = Math.random().toString(36).substr(2)\r\n  return 'uid-' + key\r\n}\r\n\r\nexport default makeUid","<template>\r\n  <CInputFile :placeholder=\"UploadImageSelectedStr\" custom :horizontal=\"horizontal\" :required=\"isRequired\" accept=\"image/*\" @change=\"GetUploadImage\" :id=\"safeId\" class=\"form-group\">\r\n    <!-- Label -->\r\n    <template v-if=\"horizontal\" #label>\r\n      <span :class=\"LabelGridClass\">\r\n        {{ label }}\r\n        <span v-if=\"isRequired\" class=\"text-danger\">*</span>\r\n      </span>\r\n    </template>\r\n    <!-- 圖片預覽 -->\r\n    <template #description>\r\n      <div v-show=\"ImagePreviewSrc\" class=\"mt-2\">\r\n        <!-- --小標題-- -->\r\n        <small class=\"d-block\">{{ ImagePreviewTitle }}</small>\r\n        <!-- --圖片-- -->\r\n        <label :for=\"safeId\" class=\"position-relative img-thumbnail bg-white\">\r\n          <img :src=\"ImagePreviewSrc\" alt=\"\" :style=\"`max-width:${maxPreview}`\" />\r\n          <!-- --刪除上傳圖片的按鈕-- -->\r\n          <CButton v-show=\"UploadImage\" color=\"danger\" shape=\"pill\" @click=\"removeUploadImage\" class=\"align-top p-1\">\r\n            <CIcon name=\"cil-x\" size=\"sm\" class=\"m-0\" />\r\n          </CButton>\r\n        </label>\r\n      </div>\r\n    </template>\r\n  </CInputFile>\r\n</template>\r\n\r\n<script>\r\nimport { makeUid } from \"@coreui/utils/src\";\r\n\r\nexport default {\r\n  name: \"ImageInput\",\r\n  props: {\r\n    value: {\r\n      type: String,\r\n    },\r\n    label: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    wasValidated: Boolean,\r\n    // 橫向排版(CInput的)\r\n    horizontal: {\r\n      type: [Boolean, Object],\r\n      default: false,\r\n    },\r\n    // 原有圖片\r\n    oldImage: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    // 上傳的檔案大小限制\r\n    limitSize: {\r\n      type: Number,\r\n    },\r\n    // 上傳的檔案大小限制之單位\r\n    limitUnit: {\r\n      type: String,\r\n      default: \"KB\",\r\n    },\r\n    // 預覽圖的最大寬度\r\n    maxPreview: {\r\n      type: String,\r\n      default: \"100%\",\r\n    },\r\n  },\r\n  watch: {\r\n    value(val) {\r\n      this.UploadImage = val;\r\n    },\r\n    UploadImage(val) {\r\n      this.$emit(\"update:value\", val);\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // 上傳的圖片(base64字串)\r\n      UploadImage: \"\",\r\n      // 上傳的圖片的檔名\r\n      UploadImageName: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    // 產生id\r\n    safeId() {\r\n      if (this.id || this.$attrs.id) {\r\n        return this.id || this.$attrs.id;\r\n      }\r\n      return makeUid();\r\n    },\r\n    // 是否需要必填\r\n    isRequired() {\r\n      if (this.oldImage == \"\") {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    // Label排版的class\r\n    LabelGridClass() {\r\n      if (this.horizontal === true) {\r\n        return \"col-sm-3 col-form-label\";\r\n      } else if (this.horizontal instanceof Object) {\r\n        return this.horizontal.label + \" col-form-label\";\r\n      }\r\n      return;\r\n    },\r\n    // 選擇檔案所顯示的文字\r\n    UploadImageSelectedStr() {\r\n      if (this.UploadImageName == \"\") {\r\n        return \"尚未選擇檔案\";\r\n      }\r\n      return this.UploadImageName;\r\n    },\r\n    // 預覽圖片區塊的小標題\r\n    ImagePreviewTitle() {\r\n      if (this.oldImage && !this.UploadImage) {\r\n        return \"現有影像\";\r\n      }\r\n      if (this.UploadImage) {\r\n        return \"上傳預覽\";\r\n      }\r\n    },\r\n    // 預覽圖片的src\r\n    ImagePreviewSrc() {\r\n      if (this.oldImage && !this.UploadImage) {\r\n        return this.oldImage;\r\n      }\r\n      if (this.UploadImage) {\r\n        return this.UploadImage;\r\n      }\r\n      return \"\";\r\n    },\r\n  },\r\n  methods: {\r\n    // 檔案上傳與圖片預覽\r\n    GetUploadImage(files, event) {\r\n      // const file = e.target.files.item(0);\r\n      // --(CInputFile傳過來的已經是e.target.files)\r\n      const file = files.item(0);\r\n      if (file) {\r\n        // valid:檢查圖片限制的結果\r\n        let valid = this.limitSize ? this.Validfile(file, \"image\", this.limitSize, this.limitUnit) : true;\r\n        // 顯示預覽圖、圖片存入data\r\n        if (valid) {\r\n          //--建立 reader 變數為一個檔案讀取器物件\r\n          this.UploadImageName = file.name;\r\n          const reader = new FileReader();\r\n          //--先準備好讀取器讀取檔案後要執行的工作\r\n          reader.addEventListener(\"load\", (e) => {\r\n            //----將 e.target.result (也就是讀取器接收到的檔案資訊)存入data\r\n            this.UploadImage = e.target.result;\r\n          });\r\n          //--讀取器讀取上傳的檔案內容\r\n          reader.readAsDataURL(file);\r\n        } else {\r\n          // 檢查不通過\r\n          this.removeUploadImage();\r\n        }\r\n      }\r\n    },\r\n    // 檢查圖片檔案大小\r\n    Validfile(file, type, size, unit) {\r\n      switch (unit) {\r\n        case \"Byte\":\r\n          var fileUnit = 1;\r\n          break;\r\n        case \"KB\":\r\n          var fileUnit = 1024;\r\n          break;\r\n        case \"MB\":\r\n          var fileUnit = 1024 * 1024;\r\n          break;\r\n        case \"GB\":\r\n          var fileUnit = 1024 * 1024 * 1024;\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n      let fileSize = (file.size / fileUnit).toFixed(0);\r\n      let fileType = file.name.substring(file.name.lastIndexOf(\".\"));\r\n\r\n      switch (type) {\r\n        case \"image\":\r\n          if (!fileType.match(/.jpg|.jpeg|.png|.svg/i)) {\r\n            alert(\"請上傳圖片檔案(.jpg|.jpeg|.png|.svg)\");\r\n            return false;\r\n          }\r\n          break;\r\n        default:\r\n          console.error(\"type_參數設置錯誤！\");\r\n          return false;\r\n          break;\r\n      }\r\n      if (fileSize > size) {\r\n        alert(\"檔案不能超過\" + size + unit);\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    // 移除上傳的圖片\r\n    removeUploadImage() {\r\n      this.UploadImage = \"\";\r\n      this.UploadImageName = \"\";\r\n      document.getElementById(this.safeId).value = null;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.img-thumbnail {\r\n  img {\r\n    width: 100%;\r\n    height: auto;\r\n  }\r\n  .btn {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    transform: translate(50%, -40%);\r\n    line-height: 1;\r\n    opacity: 0.6;\r\n    &:hover {\r\n      opacity: 1;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImageInput.vue?vue&type=template&id=37f136e6&scoped=true&\"\nimport script from \"./ImageInput.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ImageInput.vue?vue&type=style&index=0&id=37f136e6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"37f136e6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CCard',[_c('CCardHeader',{staticClass:\"h5 font-weight-bold\"},[_c('CIcon',{staticClass:\"mt-0\",attrs:{\"name\":\"cil-list-numbered\"}}),_vm._v(\" \"+_vm._s(this.$route.name)+\" \")],1),_c('CCardBody',[_c('CRow',{staticClass:\"needs-validation\",attrs:{\"tag\":\"form\",\"id\":\"updateForm\"}},[_c('CCol',{attrs:{\"sm\":\"6\",\"md\":\"5\"}},[_c('div',{staticClass:\"cate-info rounded p-3 mb-5 mb-sm-0\"},[_c('CInput',{ref:\"inputName\",attrs:{\"label\":\"名稱\",\"placeholder\":\"請填寫類別名稱\",\"invalidFeedback\":\"必填\",\"horizontal\":\"\",\"required\":\"\",\"maxlength\":\"10\",\"id\":\"inputName\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_c('label',{staticClass:\"col-sm-3 col-form-label\",attrs:{\"for\":\"inputName\"}},[_vm._v(\" 名稱 \"),_c('span',{staticClass:\"text-danger\"},[_vm._v(\"*\")])])]},proxy:true}]),model:{value:(_vm.mealCateData.name_zh),callback:function ($$v) {_vm.$set(_vm.mealCateData, \"name_zh\", $$v)},expression:\"mealCateData.name_zh\"}}),_c('CInput',{ref:\"inputSlug\",attrs:{\"placeholder\":\"請填寫Slug\",\"invalidFeedback\":\"必填\",\"horizontal\":\"\",\"required\":\"\",\"maxlength\":\"10\",\"id\":\"inputSlug\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_c('label',{staticClass:\"col-sm-3 col-form-label\",attrs:{\"for\":\"inputSlug\"}},[_vm._v(\" Slug \"),_c('span',{staticClass:\"text-danger\"},[_vm._v(\"*\")]),_c('CIcon',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:('網址使用的別名'),expression:\"'網址使用的別名'\"}],staticClass:\"icon-circle bg-warning text-white ml-2\",attrs:{\"name\":\"cil-lightbulb\"}})],1)]},proxy:true}]),model:{value:(_vm.mealCateData.name),callback:function ($$v) {_vm.$set(_vm.mealCateData, \"name\", $$v)},expression:\"mealCateData.name\"}}),_c('ImageInput',{attrs:{\"label\":\"圖示\",\"horizontal\":\"\",\"limitSize\":300,\"limitUnit\":\"KB\",\"maxPreview\":\"120px\",\"oldImage\":_vm.mealCateData.icon,\"value\":_vm.UploadImage},on:{\"update:value\":function($event){_vm.UploadImage=$event}}})],1)]),_c('CCol',{attrs:{\"sm\":\"6\",\"md\":\"7\"}},[_c('p',{staticClass:\"d-flex justify-content-between align-items-center h5 font-weight-bold\"},[_vm._v(\" 子類別 \"),_c('IconButton',{staticClass:\"text-white mr-2\",attrs:{\"size\":\"sm\",\"color\":\"info\",\"icon\":\"cil-playlist-add\"},on:{\"clickFn\":function($event){return _vm.addSubCate()}}},[_vm._v(\"新增子類別\")])],1),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.subCateList.length == 0),expression:\"subCateList.length == 0\"}],staticClass:\"text-muted text-center my-4\"},[_vm._v(\"尚無子類別\")]),_c('draggable',{staticClass:\"list-unstyled px-4\",attrs:{\"tag\":\"ul\",\"list\":_vm.subCateList,\"handle\":\".move-icon\",\"animation\":200},on:{\"change\":function($event){_vm.changed = true}}},[_c('transition-group',{attrs:{\"name\":\"flip-list\"}},_vm._l((_vm.subCateList),function(subCate,idx){return _c('li',{key:(\"subCate\" + idx),staticClass:\"row align-items-center border list-group-item-info mb-3\"},[_c('CIcon',{attrs:{\"name\":\"cil-elevator\",\"customClasses\":\"move-icon\"}}),_c('CInput',{staticClass:\"col p-0 mb-0\",attrs:{\"placeholder\":\"請填寫子類別名稱\",\"addInputClasses\":\"input-subCate\",\"required\":\"\",\"maxlength\":\"10\"},model:{value:(subCate.name),callback:function ($$v) {_vm.$set(subCate, \"name\", $$v)},expression:\"subCate.name\"}}),_c('CButton',{staticClass:\"del-btn\",on:{\"click\":function($event){return _vm.delSubCate(idx)}}},[_c('CIcon',{attrs:{\"name\":\"cil-trash\"}})],1)],1)}),0)],1)],1)],1)],1),_c('CCardFooter',{attrs:{\"align\":\"right\"}},[(_vm.currId)?_c('IconButton',{staticClass:\"float-left\",attrs:{\"color\":\"danger\",\"icon\":\"cil-trash\"},on:{\"clickFn\":function($event){return _vm.del()}}},[_vm._v(\"刪除此類別\")]):_vm._e(),_c('CButton',{staticClass:\"mr-3\",attrs:{\"color\":\"secondary\",\"variant\":\"outline\",\"to\":\"/mngt/meal/cate/\"}},[_vm._v(\"取消\")]),_c('CButton',{attrs:{\"color\":\"success\"},on:{\"click\":function($event){return _vm.save()}}},[_vm._v(\"儲存設定\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import ApiUrl from \"@/const/apiUrl.js\";\r\nimport AjaxService from \"@/services/ajaxService.js\";\r\nimport draggable from \"vuedraggable\";\r\nimport ImageInput from \"@/components/ImageInput\";\r\n\r\nexport default {\r\n  name: \"MealCateEdit\",\r\n  components: {\r\n    draggable,\r\n    ImageInput,\r\n  },\r\n  data() {\r\n    return {\r\n      // 當前餐點類別ID\r\n      currId: this.$route.params.id,\r\n      // 當前餐點類別資料\r\n      mealCateData: {\r\n        id: \"\",\r\n        name: \"\",\r\n        name_zh: \"\",\r\n        icon: \"\",\r\n        sort: \"\",\r\n        subCateList: Array(),\r\n      },\r\n      // DB中的當前餐點類別資料\r\n      db_mealCateData: {},\r\n      // 上傳的圖片(base64字串)\r\n      UploadImage: \"\",\r\n      // 是否曾經改動過\r\n      changed: false,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  methods: {\r\n    init() {\r\n      if (this.currId !== undefined) {\r\n        this.getMealCateData();\r\n      }\r\n    },\r\n    // 取得當前餐點類別資料\r\n    getMealCateData() {\r\n      this.$store.commit(\"set\", [\"globalLoading\", true]);\r\n      let url = ApiUrl.getUrl(\"mealCate\", \"getOne\") + this.currId;\r\n      AjaxService.get(\r\n        url,\r\n        (successResp) => {\r\n          if (successResp.restData) {\r\n            let resultData = successResp.restData[0];\r\n            this.mealCateData = {\r\n              id: resultData.id,\r\n              name: resultData.name,\r\n              name_zh: resultData.zhName,\r\n              icon: resultData.icon,\r\n              sort: resultData.sort,\r\n              subCateList: resultData.subCateList,\r\n            };\r\n            // 紀錄db的原始資料\r\n            this.db_mealCateData = { ...this.mealCateData };\r\n            this.db_mealCateData.subCateList = resultData.subCateList.map((item) => {\r\n              return { ...item };\r\n            });\r\n            this.$store.commit(\"set\", [\"globalLoading\", false]);\r\n            console.log(\"查詢餐點類別成功!\");\r\n          }\r\n        },\r\n        (errorResp) => {\r\n          console.log(\"查詢餐點類別失敗!\");\r\n          console.log(errorResp);\r\n        }\r\n      );\r\n    },\r\n    // 檢查頁面內容是否曾修改過\r\n    checkChanged() {\r\n      let cateChanged = JSON.stringify(this.mealCateData) != JSON.stringify(this.db_mealCateData);\r\n      // 是否有 修改過排序 或 修改過input欄位資料 或 選擇圖檔\r\n      if (this.changed || cateChanged || this.UploadImage) {\r\n        if (confirm(\"頁面內容曾修改過，尚未儲存修改的變更將會捨棄！\\n是否確定要離開此頁面？\")) {\r\n          // 確定離開\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n      // 未曾修改=>確定離開\r\n      return true;\r\n    },\r\n    // 增加子類別\r\n    addSubCate() {\r\n      this.subCateList.push({\r\n        id: \"\",\r\n        name: \"\",\r\n        sort: \"\",\r\n      });\r\n      this.$nextTick(() => {\r\n        let idx = this.subCateList.length - 1;\r\n        document.querySelectorAll(\".input-subCate\").item(idx).focus();\r\n      });\r\n    },\r\n    // 刪除子類別\r\n    delSubCate(idx) {\r\n      if (this.subCateList[idx].id != \"\") {\r\n        if (confirm(\"將會連同類別中的餐點一並刪除！是否確定要刪除？\\n***** 請注意！刪除後無法復原！*****\")) {\r\n          if (this.checkChanged()) {\r\n            this.$store.commit(\"set\", [\"globalLoading\", true]);\r\n            let url = ApiUrl.getUrl(\"mealCate\", \"deleteSub\") + this.subCateList[idx].id;\r\n            AjaxService.delete(\r\n              url,\r\n              (successResp) => {\r\n                this.$store.commit(\"set\", [\"globalLoading\", false]);\r\n                console.log(\"刪除餐點子類別成功!\");\r\n                this.init();\r\n              },\r\n              (errorResp) => {\r\n                console.log(\"刪除餐點子類別失敗!\");\r\n                console.log(errorResp);\r\n              }\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        this.subCateList.splice(idx, 1);\r\n      }\r\n    },\r\n    // 送出資料儲存\r\n    save() {\r\n      const form = document.querySelector(\"#updateForm\");\r\n      form.classList.add(\"was-validated\");\r\n      if (form.checkValidity() === true) {\r\n        this.$store.commit(\"set\", [\"globalLoading\", true]);\r\n        // 處理子類別排序\r\n        let subData = this.subCateList.map((item, idx) => {\r\n          item.sort = idx + 1;\r\n          return item;\r\n        });\r\n        // 處理圖片資料\r\n        let image = this.UploadImage != \"\" ? this.UploadImage : this.mealCateData.icon;\r\n        // 最終資料\r\n        let sendData = {\r\n          id: this.mealCateData.id,\r\n          name: this.mealCateData.name,\r\n          zhName: this.mealCateData.name_zh,\r\n          icon: image,\r\n          sort: this.mealCateData.sort,\r\n          subCateList: subData,\r\n        };\r\n\r\n        let url = ApiUrl.getUrl(\"mealCate\", \"save\");\r\n        AjaxService.post(\r\n          url,\r\n          sendData,\r\n          (successResp) => {\r\n            this.$store.commit(\"set\", [\"globalLoading\", false]);\r\n            console.log(\"修改餐點類別成功!\");\r\n            this.$router.push(\"/mngt/meal/cate\");\r\n          },\r\n          (errorResp) => {\r\n            console.log(\"修改餐點類別失敗!\");\r\n            console.log(errorResp);\r\n            if ((errorResp.appCode = \"ERROR_002\")) {\r\n              this.$store.commit(\"set\", [\"globalLoading\", false]);\r\n              const errorMsg = errorResp.response.data.appMsg;\r\n              // 錯誤的input\r\n              let $input = errorMsg == \"Slug 不得重複\" ? this.$refs.inputSlug : this.$refs.inputName;\r\n              // 加樣式、訊息、focus\r\n              $input.addInputClasses = \"is-invalid\";\r\n              $input.invalidFeedback = errorMsg;\r\n              document.getElementById($input.safeId).focus();\r\n              // 避免和form驗證結果的樣式衝突\r\n              form.classList.remove(\"was-validated\");\r\n              alert(errorMsg);\r\n            }\r\n          }\r\n        );\r\n      } else {\r\n        document.querySelector(\"input:invalid,select:invalid,textarea:invalid\").focus();\r\n      }\r\n    },\r\n    del() {\r\n      if (confirm(\"將會連同類別中的餐點一並刪除！ 是否確定要刪除？\\n***** 請注意！刪除後無法復原！*****\")) {\r\n        this.$store.commit(\"set\", [\"globalLoading\", true]);\r\n        let url_base = ApiUrl.getUrl(\"mealCate\", \"delete\");\r\n        AjaxService.delete(\r\n          url_base + this.mealCateData.id,\r\n          (successResp) => {\r\n            this.$store.commit(\"set\", [\"globalLoading\", false]);\r\n            console.log(\"刪除成功!\");\r\n            this.$router.push(\"/mngt/meal/cate\");\r\n          },\r\n          (errorResp) => {\r\n            console.log(\"刪除失敗!\");\r\n            console.log(errorResp);\r\n          }\r\n        );\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    // 餐點子類別\r\n    subCateList() {\r\n      return this.mealCateData.subCateList;\r\n    },\r\n  },\r\n};\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./MealCateEdit.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./MealCateEdit.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MealCateEdit.vue?vue&type=template&id=7a4738e6&scoped=true&\"\nimport script from \"./MealCateEdit.js?vue&type=script&lang=js&\"\nexport * from \"./MealCateEdit.js?vue&type=script&lang=js&\"\nimport style0 from \"./MealCateEdit.vue?vue&type=style&index=0&id=7a4738e6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7a4738e6\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageInput.vue?vue&type=style&index=0&id=37f136e6&lang=scss&scoped=true&\""],"sourceRoot":""}