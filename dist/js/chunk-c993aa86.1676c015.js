(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c993aa86"],{"442a":function(t,e,a){"use strict";a("73e0")},"73e0":function(t,e,a){},c4f1:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CButtonToolbar",{attrs:{justify:""}},[a("IconButton",{staticClass:"text-white my-1 mr-2",attrs:{color:"warning",size:"sm",icon:"cil-pencil"},on:{clickFn:function(e){return t.edit()}}},[t._v("編輯")]),a("IconButton",{staticClass:"text-white my-1 mr-2",attrs:{color:"danger",size:"sm",icon:"cil-trash"},on:{clickFn:function(e){return t.del()}}},[t._v("刪除")])],1)},i=[],s=a("35ab"),o=a("20fc"),r={name:"ProcessButtons",props:{isChange:{type:Boolean,default:!1},itemId:{required:!0},itemGroup:{type:String,required:!0},editUrl:{type:String,default:""},delUrl:{type:String,default:""},delMsg:{type:String,default:""}},data:function(){return{}},methods:{checkChanged:function(){return!this.isChange||!!confirm("頁面內容曾修改過，尚未儲存修改的變更將會捨棄！\n是否確定要離開此頁面？")},edit:function(){if(this.checkChanged()){var t=""==this.editUrl?s["a"].getUrl(this.itemGroup,"edit"):this.editUrl;this.$router.push(t+this.itemId)}},del:function(){var t=this;if(confirm(this.delAlertStr)&&this.checkChanged()){this.$store.commit("set",["globalLoading",!0]);var e=""==this.delUrl?s["a"].getUrl(this.itemGroup,"delete"):this.delUrl;o["a"].delete(e+this.itemId,(function(e){t.$store.commit("set",["globalLoading",!1]),console.log("刪除成功!"),t.$emit("reloadFn")}),(function(t){console.log("刪除失敗!"),console.log(t)}))}}},computed:{delAlertStr:function(){return this.delMsg+"是否確定要刪除？\n***** 請注意！刪除後無法復原！*****"}}},c=r,l=a("2877"),u=Object(l["a"])(c,n,i,!1,null,"9e645470",null);e["a"]=u.exports},cc6c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CCard",[a("CCardHeader",{staticClass:"h5 font-weight-bold"},[a("CIcon",{staticClass:"mt-0",attrs:{name:"cil-list-numbered"}}),t._v(" 餐點類別管理 ")],1),a("CCardBody",[a("CAlert",{attrs:{color:"info",closeButton:""}},[t._v(" 拖曳前方的 "),a("span",{staticClass:"border border-dark px-1"},[a("CIcon",{staticClass:"align-text-bottom",attrs:{name:"cil-elevator"}})],1),t._v(" 來進行排序，修改後請按下方的 "),a("span",{staticClass:"border border-dark rounded px-1"},[t._v("儲存排序")]),t._v(" 。 ")]),a("draggable",{staticClass:"list-unstyled px-4",attrs:{tag:"ul",list:t.mealCateList,handle:".move-icon",animation:200},on:{change:function(e){t.changed=!0}}},[a("transition-group",{attrs:{name:"flip-list"}},t._l(t.mealCateList,(function(e){return a("li",{key:e.id,staticClass:"row border mb-3"},[a("CIcon",{attrs:{name:"cil-elevator",customClasses:"move-icon border-right"}}),a("CButton",{staticClass:"col text-left",attrs:{size:""},on:{click:function(a){return t.activeCateChanged(e.id)}}},[t._v(" "+t._s(e.name_zh)+" "),a("CIcon",{staticClass:"collapse-icon float-right",class:{open:t.checkActiveCate(e.id)},attrs:{name:"cil-caret-bottom"}})],1),a("CCollapse",{staticClass:"col-12 border-top p-3",attrs:{show:t.checkActiveCate(e.id)}},[a("CRow",[a("CCol",{staticClass:"mb-3 mb-sm-0",attrs:{sm:"4",md:"3"}},[t._v(" 圖示： "),a("img",{staticClass:"img-thumbnail bg-white align-top",attrs:{src:e.icon,alt:""}})]),a("CCol",{staticClass:"pb-4",attrs:{sm:"8",md:"9"}},[a("p",[t._v(" 名稱： "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name_zh))])]),a("p",[t._v(" Slug： "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])]),a("p",[t._v(" 子類別： "),"undefined"===typeof t.mealSubCateList[e.id]?a("span",{staticClass:"text-muted"},[t._v("無")]):t._l(t.mealSubCateList[e.id],(function(e){return a("span",{key:"subCate_"+e.id,staticClass:"d-inline-block border rounded p-2 mb-2 mr-2"},[t._v(t._s(e.name))])}))],2),a("ProcessButtons",{attrs:{"is-change":t.changed,"item-id":e.id,"item-group":"mealCate","edit-url":"/mngt/meal/cate/edit/","del-msg":"將會連同類別中的餐點一並刪除！ "},on:{reloadFn:t.init}})],1)],1)],1)],1)})),0)],1)],1),a("CCardFooter",{attrs:{align:"right"}},[a("CButton",{staticClass:"mr-2",attrs:{color:"info"},on:{click:function(e){return t.addCate()}}},[t._v("新增類別")]),a("CButton",{attrs:{color:"success"},on:{click:function(e){return t.saveSort()}}},[t._v("儲存排序")])],1)],1)},i=[],s=a("35ab"),o=a("20fc"),r=a("b76a"),c=a.n(r),l=a("c4f1"),u={name:"MealCategory",components:{draggable:c.a,ProcessButtons:l["a"]},data:function(){return{mealCateList:[],mealSubCateList:[],activeCate:"",changed:!1}},mounted:function(){this.init()},methods:{init:function(){this.getMealCateList(),this.getMealSubCateList()},getMealCateList:function(){var t=this;this.$store.commit("set",["globalLoading",!0]);var e=s["a"].getUrl("mealCate","getAll");o["a"].get(e,(function(e){if(e.restData){var a=e.restData;t.mealCateList=a.map((function(t){var e={id:t.id,name:t.name,name_zh:t.zhName,icon:t.icon};return e})),t.$store.commit("set",["globalLoading",!1]),console.log("查詢餐點類別成功!")}}),(function(t){console.log("查詢餐點類別失敗!"),console.log(t)}))},getMealSubCateList:function(){var t=this;this.$store.commit("set",["globalLoading",!0]);var e=s["a"].getUrl("mealCate","getAllSub");o["a"].get(e,(function(e){e.restData&&(e.restData.forEach((function(e){t.mealSubCateList[e.categoryId]=e.subCateList})),t.$store.commit("set",["globalLoading",!1]),console.log("查詢餐點子類別成功!"))}),(function(t){console.log("查詢餐點子類別失敗!"),console.log(t)}))},currSubCateList:function(t){return this.mealSubCateList.find((function(e){return e.categoryId===t}))},activeCateChanged:function(t){this.activeCate=this.activeCate==t?"":t},checkActiveCate:function(t){return this.activeCate==t},checkChanged:function(){return!this.changed||!!confirm("頁面內容曾修改過，尚未儲存修改的變更將會捨棄！\n是否確定要離開此頁面？")},addCate:function(){this.checkChanged()&&this.$router.push("/mngt/meal/cate/create")},saveSort:function(){var t=this;this.$store.commit("set",["globalLoading",!0]);var e=this.mealCateList.map((function(t,e){var a={id:t.id,sort:e+1};return a})),a=s["a"].getUrl("mealCate","saveSort");o["a"].put(a,e,(function(e){t.$store.commit("set",["globalLoading",!1]),console.log("修改餐點類別排序成功!"),t.init()}),(function(t){console.log("修改餐點類別排序失敗!"),console.log(t)}))}}},d=u,m=(a("442a"),a("2877")),g=Object(m["a"])(d,n,i,!1,null,"3d11bd23",null);e["default"]=g.exports}}]);
//# sourceMappingURL=chunk-c993aa86.1676c015.js.map